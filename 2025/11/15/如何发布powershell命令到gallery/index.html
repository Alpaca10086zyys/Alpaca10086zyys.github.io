<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Alpaca Zhang">





<title>å¦‚ä½•å‘å¸ƒpowershellå‘½ä»¤åˆ°gallery | Alpaca Zhang&#39;s Blog</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 7.0.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "Â· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "Â· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Alpaca&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Alpaca&#39;s Blog</a><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // ä¸º 6 æ—¶å±•å¼€æ‰€æœ‰
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // è¿™ä¸ªå€¼æ˜¯ç”± tocbot æºç é‡Œå®šä¹‰çš„ scrollSmoothDuration å¾—æ¥çš„
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">å¦‚ä½•å‘å¸ƒpowershellå‘½ä»¤åˆ°gallery</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Alpaca Zhang</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">åä¸€æœˆ 15, 2025&nbsp;&nbsp;15:04:18</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <blockquote>
<p>ç»å…¸èƒŒæ™¯ä»‹ç»ï¼šè¿™ä¸€åˆ‡çš„èƒŒæ™¯è¿˜æ˜¯å› ä¸ºæœ€è¿‘å®ä¹ ç¦»èŒäº†ä¹‹åç”¨å›äº†windowså¼€å‘ï¼Œwindowsä¸Šé¢çš„treeå‘½ä»¤æ„Ÿè§‰å®åœ¨æ˜¯ä¸å¥½ç”¨ï¼Œå› ä¸ºä¸èƒ½æ§åˆ¶<code>-L</code>æ·±åº¦ï¼Œå‡ ç•ªæ±‚ç´¢ä¹‹åæ²¡æ‰¾åˆ°ä¸€ä¸ªå–œæ¬¢çš„å‘½ä»¤ï¼Œæœ€åå†³å®šæ˜¯è‡ªå·±å†™ä¸€ä¸ªå·¥å…·å‘½ä»¤ï¼Œç»è¿‡è°ƒè¯•ä¹‹åè§‰å¾—è¿˜ä¸é”™æŒºå¥½ç”¨çš„ï¼Œç„¶åæˆ‘å°±åœ¨æƒ³èƒ½ä¸èƒ½è·ŸnpmåŒ…ä¸€æ ·å‘å¸ƒåˆ°å¤§å®¶éƒ½å¯ç”¨çš„é‚£ç§ç¤¾åŒºå¹³å°ä¸Šï¼Œç„¶åæˆ‘æ‰¾åˆ°äº†powershell gallery.</p>
</blockquote>
<h2 id="åˆ›å»ºpowershell-galleryè´¦æˆ·"><a class="markdownIt-Anchor" href="#åˆ›å»ºpowershell-galleryè´¦æˆ·"></a> åˆ›å»ºPowershell Galleryè´¦æˆ·</h2>
<p>ç‚¹æ­¤åˆ›å»ºè´¦æˆ·ğŸ‘‰ï¼š<a target="_blank" rel="noopener" href="https://PowerShellGallery.com">https://PowerShellGallery.com</a></p>
<p>çœ‹åˆ°è¿™é‡Œå°±è¯´æ˜åˆ›å»ºå®Œæˆï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Alpaca10086zyys/BlogImage/20251115160829.png" alt="åˆ›å»ºå®Œæˆ" /></p>
<p>ç„¶åç‚¹å‡»ç”¨æˆ·åé€‰æ‹©API Keysï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„api-keyï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Alpaca10086zyys/BlogImage/20251115162252.png" alt="é…ç½®key" /></p>
<p>ç„¶ågetåˆ°keyï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Alpaca10086zyys/BlogImage/20251115162404.png" alt="" /></p>
<h2 id="ä½¿ç”¨psscriptanalyzer"><a class="markdownIt-Anchor" href="#ä½¿ç”¨psscriptanalyzer"></a> ä½¿ç”¨PSScriptAnalyzer</h2>
<p>è¿™æ˜¯å¾®è½¯å®˜æ–¹æ–‡æ¡£å»ºè®®å®Œæˆçš„ä¼˜å…ˆçº§ç¬¬ä¸€çš„æ­¥éª¤ï¼š ä½¿ç”¨PSScriptAnalyzerè¯†åˆ«PowerShellä»£ç ä¸­æœ€å¸¸è§çš„é—®é¢˜ï¼Œå¹¶ä¸”é€šå¸¸ä¼šæä¾›æœ‰å…³å¦‚ä½•è§£å†³é—®é¢˜çš„å»ºè®®ã€‚</p>
<h3 id="1-å®‰è£…-psscriptanalyzer"><a class="markdownIt-Anchor" href="#1-å®‰è£…-psscriptanalyzer"></a> 1. å®‰è£… PSScriptAnalyzer</h3>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Install-Module</span> PSScriptAnalyzer <span class="literal">-Scope</span> CurrentUser</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹ç‰ˆæœ¬ï¼š</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Module</span> PSScriptAnalyzer <span class="literal">-ListAvail</span></span><br></pre></td></tr></table></figure>
<h3 id="2-å¯¹è„šæœ¬è¿›è¡Œæ‰«æ"><a class="markdownIt-Anchor" href="#2-å¯¹è„šæœ¬è¿›è¡Œæ‰«æ"></a> 2. å¯¹è„šæœ¬è¿›è¡Œæ‰«æ</h3>
<p>æ¯”å¦‚è¿™æ˜¯æˆ‘çš„è„šæœ¬è·¯å¾„ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\TreeView-PS\TreeView.ps1</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Invoke-ScriptAnalyzer</span> <span class="literal">-Path</span> <span class="string">&quot;D:\TreeView-PS\TreeView.ps1&quot;</span></span><br></pre></td></tr></table></figure>
<p>ä¼šè¾“å‡ºç±»ä¼¼ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">RuleName                            Severity Line Message</span><br><span class="line">--------                            -------- ---- -------</span><br><span class="line">PSAvoidUsingWriteHost               Warning  33  FileTree.cmd uses Write-Host; use Write-Output instead.</span><br><span class="line">PSUseDeclaredVarsMoreThanAssignments Warning ...</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/Alpaca10086zyys/BlogImage/20251115174945.png" alt="æ‰«æpesterç‰ˆæœ¬" /></p>
<p>å‚è€ƒè¿™é‡Œçš„é—®é¢˜æŠŠé—®é¢˜éƒ½è§£å†³ã€‚ç›´åˆ°ä½¿ç”¨æ‰«æå‘½ä»¤æ— è¾“å‡ºã€‚</p>
<h3 id="3-å¯¹æ•´ä¸ªæ¨¡å—æ‰«æ"><a class="markdownIt-Anchor" href="#3-å¯¹æ•´ä¸ªæ¨¡å—æ‰«æ"></a> 3. å¯¹æ•´ä¸ªæ¨¡å—æ‰«æ</h3>
<p>å¦‚æœä½ ç»„ç»‡æˆæ¨¡å—ç»“æ„ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TreeView/</span><br><span class="line">  TreeView.psd1</span><br><span class="line">  TreeView.psm1</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œï¼š</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Invoke-ScriptAnalyzer</span> <span class="literal">-Path</span> <span class="string">&quot;TreeView&quot;</span> <span class="literal">-Recurse</span></span><br></pre></td></tr></table></figure>
<hr />
<h3 id="4-è‡ªåŠ¨ä¿®å¤å¦‚æœå¯èƒ½"><a class="markdownIt-Anchor" href="#4-è‡ªåŠ¨ä¿®å¤å¦‚æœå¯èƒ½"></a> 4. è‡ªåŠ¨ä¿®å¤ï¼ˆå¦‚æœå¯èƒ½ï¼‰</h3>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Invoke-ScriptAnalyzer</span> <span class="literal">-Path</span> .\TreeView.ps1 <span class="literal">-Fix</span></span><br></pre></td></tr></table></figure>
<p>ä¸æ˜¯æ‰€æœ‰è§„åˆ™éƒ½èƒ½è‡ªåŠ¨ä¿®ï¼Œä½†èƒ½è‡ªåŠ¨ fix çš„å°±ä¼šå¸®ä½ å¤„ç†ã€‚</p>
<h3 id="5-å‘å¸ƒå‰è‡ªåŠ¨æ£€æŸ¥"><a class="markdownIt-Anchor" href="#5-å‘å¸ƒå‰è‡ªåŠ¨æ£€æŸ¥"></a> 5. å‘å¸ƒå‰è‡ªåŠ¨æ£€æŸ¥</h3>
<p>å¯ä»¥åœ¨å‘å¸ƒå‰å…ˆè·‘ï¼š</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Invoke-ScriptAnalyzer</span> <span class="literal">-Path</span> . <span class="literal">-Recurse</span> <span class="literal">-Severity</span> Warning,Error</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæœªæ¥ç”¨ GitHub Actions å‘å¸ƒæ¨¡å—ï¼Œå¯ä»¥åŠ ï¼š</p>
<p><code>.github/workflows/lint.yml</code>ï¼š</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Lint</span> <span class="string">PowerShell</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span> [<span class="string">push</span>, <span class="string">pull_request</span>]</span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">analyze:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">windows-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v3</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">PSScriptAnalyzer</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">Install-Module</span> <span class="string">PSScriptAnalyzer</span> <span class="string">-Force</span> <span class="string">-Scope</span> <span class="string">CurrentUser</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">Analyzer</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">Invoke-ScriptAnalyzer</span> <span class="string">-Path</span> <span class="string">.</span> <span class="string">-Recurse</span> <span class="string">-Severity</span> <span class="string">Warning,Error</span></span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨pesterè¿›è¡Œå•å…ƒæµ‹è¯•"><a class="markdownIt-Anchor" href="#ä½¿ç”¨pesterè¿›è¡Œå•å…ƒæµ‹è¯•"></a> ä½¿ç”¨Pesterè¿›è¡Œå•å…ƒæµ‹è¯•</h2>
<h3 id="å®‰è£…ç°ä»£ç‰ˆæœ¬çš„pester"><a class="markdownIt-Anchor" href="#å®‰è£…ç°ä»£ç‰ˆæœ¬çš„pester"></a> å®‰è£…ç°ä»£ç‰ˆæœ¬çš„Pester</h3>
<blockquote>
<p>Windows 10 / Windows Server 2016 åŠæ›´é«˜ç‰ˆæœ¬é¢„è£…äº† Pester 3.4.0 ç‰ˆæœ¬ã€‚æ­¤å†…ç½®ç‰ˆæœ¬æ— æ³•ä½¿ç”¨ç®€å•çš„Update-Modulecmdlet è¿›è¡Œæ›´æ–°ã€‚æ‚¨éœ€è¦æ‰§è¡Œå¹¶è¡Œå®‰è£…æ‰èƒ½å¼€å§‹ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ Pesterã€‚</p>
<p>å†…ç½®ç‰ˆæœ¬ç”±å¾®è½¯ç­¾åï¼Œè€Œè¾ƒæ–°çš„ç‰ˆæœ¬ç”±ç¤¾åŒºç»´æŠ¤å¹¶ä½¿ç”¨ä¸åŒçš„è¯ä¹¦ç­¾åï¼Œè¿™Install-Moduleæœ‰æ—¶ä¼šå¯¼è‡´å‡ºç°é”™è¯¯ï¼Œè¦æ±‚æˆ‘ä»¬æ¥å—æ–°çš„å‘å¸ƒè€…è¯ä¹¦ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://pester.dev/docs/introduction/installation#installing-from-powershell-gallery">Installation and Update | Pester</a></p>
</blockquote>
<p>é¦–å…ˆå®‰è£…Pester 5.x ç°ä»£ç‰ˆæœ¬ï¼Œç”±äºç³»ç»Ÿé‡Œé¢„ç½®äº†ä¸å†æ›´æ–°çš„3.xï¼Œ æ‰€ä»¥å®‰è£…æ–°ç‰ˆåº”å½“ä½¿ç”¨å‚æ•°è·³è¿‡ç³»ç»Ÿæ£€æŸ¥ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Install-Module -Name Pester -Force -Scope CurrentUser -SkipPublisherCheck</span><br></pre></td></tr></table></figure>
<p>å®‰è£…å®Œæˆä¹‹åå¯ä»¥ç”¨æ­¤å‘½ä»¤éªŒè¯ç‰ˆæœ¬ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-Module -ListAvailable Pester</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/Alpaca10086zyys/BlogImage/20251116150704.png" alt="" /></p>
<p>çœ‹åˆ°æœ‰äº†5.7.1å°±è¯´æ˜å°±ç»ªäº†ï¼Œç„¶åæœ€å¥½æ˜¯å¸è½½å·²åŠ è½½çš„Pester3ï¼Œå¦åˆ™ä¸ä¼šç”¨5.xç‰ˆæœ¬ï¼Œè¿è¡Œä¸‹é¢å‘½ä»¤å¸è½½é å‰çš„ç‰ˆæœ¬å¹¶æ‰‹åŠ¨åŠ è½½æ–°ç‰ˆï¼ˆ5.0.0ä»¥åçš„ç‰ˆæœ¬ï¼‰ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Remove-Module Pester -Force -ErrorAction SilentlyContinue</span><br><span class="line">Import-Module Pester -MinimumVersion 5.0.0 -Force</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å†çœ‹ä¸€ä¸‹å½“å‰æ¨¡å—ç‰ˆæœ¬ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(Get-Module Pester).Version</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PS D:\TreeView-PS&gt; (Get-Module Pester).Version</span><br><span class="line"></span><br><span class="line">Major  Minor  Build  Revision</span><br><span class="line">-----  -----  -----  --------</span><br><span class="line">5      7      1      -1</span><br></pre></td></tr></table></figure>
<h3 id="æ‰§è¡Œæµ‹è¯•"><a class="markdownIt-Anchor" href="#æ‰§è¡Œæµ‹è¯•"></a> æ‰§è¡Œæµ‹è¯•</h3>
<p>ç„¶åå‡†å¤‡å¥½æµ‹è¯•è„šæœ¬ï¼Œé¡¹ç›®ç›®å½•å¦‚ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">D:\TreeView-PS</span><br><span class="line">â”œâ”€â”€ ğŸ“ Private                    <span class="comment"># ç§æœ‰æ–¹æ³•ï¼Œä¸å¯¼å‡º</span></span><br><span class="line">â”‚   â”œâ”€â”€ ğŸ“„ AnsiColors.ps1</span><br><span class="line">â”‚   â”œâ”€â”€ ğŸ“„ Get-Color.ps1</span><br><span class="line">â”‚   â”œâ”€â”€ ğŸ“„ Get-Icon.ps1</span><br><span class="line">â”‚   â”œâ”€â”€ ğŸ“„ Show-Tree.ps1</span><br><span class="line">â”‚   â””â”€â”€ ğŸ“„ Write-OutOrHost.ps1</span><br><span class="line">â”œâ”€â”€ ğŸ“ Public</span><br><span class="line">â”‚   â””â”€â”€ ğŸ“„ TreeView.ps1           <span class="comment"># ä¸»å‡½æ•°</span></span><br><span class="line">â”œâ”€â”€ ğŸ“ Tests</span><br><span class="line">â”‚   â””â”€â”€ ğŸ“„ TreeView.Tests.ps1</span><br><span class="line">â”œâ”€â”€ ğŸ“„ TreeView.psd1</span><br><span class="line">â””â”€â”€ ğŸ“„ TreeView.psm1</span><br></pre></td></tr></table></figure>
<p>åœ¨ä»“åº“æ ¹ç›®å½•æ‰§è¡Œï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿è¡Œç›®å½•ä¸‹æ‰€æœ‰æµ‹è¯•</span></span><br><span class="line">Invoke-Pester -Path .\Tests -Output Detailed</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœå¦‚ä¸‹ï¼š<br />
<img src="https://cdn.jsdelivr.net/gh/Alpaca10086zyys/BlogImage/20251116170759.png" alt="æ‰§è¡Œæµ‹è¯•æ•ˆæœ" /></p>
<h3 id="ä¸€ä¸ªæµ‹è¯•å†…éƒ¨æ¨¡å—æœªå¯¼å‡ºçš„functionçš„æ–¹æ³•"><a class="markdownIt-Anchor" href="#ä¸€ä¸ªæµ‹è¯•å†…éƒ¨æ¨¡å—æœªå¯¼å‡ºçš„functionçš„æ–¹æ³•"></a> ä¸€ä¸ªæµ‹è¯•å†…éƒ¨æ¨¡å—æœªå¯¼å‡ºçš„functionçš„æ–¹æ³•</h3>
<blockquote>
<p>åœ¨çœŸå®æ¨¡å—è®¾è®¡ä¸­ï¼Œä¸æ¨èå¯¼å‡ºå†…éƒ¨å‡½æ•°ï¼ˆPrivate Functionsï¼‰ã€‚<br />
ä¾‹å¦‚ Get-Icon / Get-Color è¿™ç±»å†…éƒ¨è¾…åŠ©å‡½æ•°ä¸åº”è¯¥æˆä¸ºæ¨¡å—çš„å¯¹å¤– APIã€‚</p>
</blockquote>
<p>å¦‚æœä½ çš„æµ‹è¯•è„šæœ¬é‡Œè¯•å›¾è®¿é—®æ¨¡å—å†…çš„å‡½æ•°ä½†å´æ²¡æœ‰å¯¼å‡ºï¼Œå¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹æŠ¥é”™ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CommandNotFoundException: æ— æ³•å°†â€œGet-Colorâ€é¡¹è¯†åˆ«ä¸º cmdletã€å‡½æ•°ã€è„šæœ¬æ–‡ä»¶æˆ–å¯è¿è¡Œç¨‹åºçš„åç§°ã€‚è¯·æ£€æŸ¥åç§°çš„æ‹¼å†™ï¼Œå¦‚æœåŒ…æ‹¬è·¯å¾„ï¼Œè¯·ç¡®ä¿è·¯å¾„æ­£ç¡®ï¼Œç„¶åå†è¯•ä¸€æ¬¡ã€‚</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥é‡‡ç”¨è¿™ä¸ªåŠæ³•â€“<strong>Dot Source</strong>ï¼š</p>
<figure class="highlight ps1"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">BeforeAll &#123;</span><br><span class="line">    <span class="comment"># å¯¼å…¥æ¨¡å—</span></span><br><span class="line">    <span class="built_in">Import-Module</span> <span class="string">&quot;<span class="variable">$PSScriptRoot</span>\..\TreeView.psm1&quot;</span> <span class="literal">-Force</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># dot-source ç§æœ‰å‡½æ•°ï¼Œä»…æµ‹è¯•ç”¨</span></span><br><span class="line">    . <span class="string">&quot;<span class="variable">$PSScriptRoot</span>\..\Private\Get-Icon.ps1&quot;</span></span><br><span class="line">    . <span class="string">&quot;<span class="variable">$PSScriptRoot</span>\..\Private\Get-Color.ps1&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š"><a class="markdownIt-Anchor" href="#æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š"></a> æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š</h3>
<p>å¦‚éœ€åŒæ—¶ç”Ÿæˆè¦†ç›–ç‡ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ªæ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://pester.dev/docs/usage/code-coverage">Generating Code Coverage Metrics | Pester</a></p>
<p>è´´ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a Pester configuration object using `New-PesterConfiguration`</span></span><br><span class="line"><span class="variable">$config</span> = New-PesterConfiguration</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the test path to specify where your tests are located. In this example, we set the path to the current directory. Pester will look into all subdirectories.</span></span><br><span class="line"><span class="variable">$config</span>.Run.Path = <span class="string">&quot;.\Tests&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># Enable Code Coverage</span></span><br><span class="line"><span class="variable">$config</span>.CodeCoverage.Enabled = <span class="variable">$true</span></span><br><span class="line"> </span><br><span class="line"><span class="variable">$config</span>.CodeCoverage.Path = <span class="string">&quot;.&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Run Pester tests using the configuration you&#x27;ve created</span></span><br><span class="line">Invoke-Pester -Configuration <span class="variable">$config</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘æŸ¥çœ‹äº†ä¸€ä¸‹ä¸ºè‡ªå·±çš„è¦†ç›–ç‡ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Starting discovery <span class="keyword">in</span> 1 files.</span><br><span class="line">Discovery found 10 tests <span class="keyword">in</span> 88ms.</span><br><span class="line">Starting code coverage.</span><br><span class="line">Running tests.</span><br><span class="line">[+] TreeView.Tests.ps1 995ms (543ms|369ms)</span><br><span class="line">Tests completed <span class="keyword">in</span> 1.01s</span><br><span class="line">Tests Passed: 10, Failed: 0, Skipped: 0, Inconclusive: 0, NotRun: 0</span><br><span class="line">Processing code coverage result.</span><br><span class="line">Covered 37.18% / 75%. 234 analyzed Commands <span class="keyword">in</span> 10 Files.</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°æˆ‘è¿™ä¸ªåˆ†æ”¯è¦†ç›–ç‡è¿˜å¾ˆä½ï¼Œä¸è¿‡è¿™å¹¶ä¸æ˜¯æœ¬åšå®¢çš„é‡ç‚¹ï¼Œè‡³äºæé«˜è¦†ç›–ç‡å¯ä»¥é€šè¿‡å…¶ä»–çš„æ‰‹æ®µæ¥å®ç°ã€‚</p>
<h2 id="æ¨é€åˆ°powershell-gallery"><a class="markdownIt-Anchor" href="#æ¨é€åˆ°powershell-gallery"></a> æ¨é€åˆ°Powershell Gallery</h2>
<h3 id="æ³¨å†Œ-powershell-gallery-api-key"><a class="markdownIt-Anchor" href="#æ³¨å†Œ-powershell-gallery-api-key"></a> æ³¨å†Œ PowerShell Gallery API Key</h3>
<p>è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰æ˜¯æœ‰å¾—åˆ°äº†ä¸€ä¸ªapi-keyçš„ï¼Œä½ åº”å½“å·²ç»å°†è¿™ä¸ªapi-keyç»™è®°åœ¨æŸå¤„ã€‚</p>
<h3 id="ç”Ÿæˆpsd1æ‰“åŒ…"><a class="markdownIt-Anchor" href="#ç”Ÿæˆpsd1æ‰“åŒ…"></a> ç”Ÿæˆpsd1ï¼ˆæ‰“åŒ…ï¼‰</h3>
<p>ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">New-ModuleManifest -Path ./TreeView.psd1 `</span><br><span class="line">    -RootModule TreeView.psm1 `</span><br><span class="line">    -ModuleVersion <span class="string">&quot;1.0.0&quot;</span> `</span><br><span class="line">    -Author <span class="string">&quot;ä½ çš„åå­—&quot;</span> `</span><br><span class="line">    -Description <span class="string">&quot;A tree command for Windows with icons and depth support.&quot;</span></span><br></pre></td></tr></table></figure>
<p>ç”Ÿæˆçš„psd1å†…å®¹åƒè¿™æ ·ï¼š</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@&#123;</span><br><span class="line">    RootModule        = &#x27;TreeView.psm1&#x27;</span><br><span class="line">    ModuleVersion     = &#x27;1.0.0&#x27;</span><br><span class="line">    GUID              = &#x27;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&#x27;</span><br><span class="line">    Author            = &#x27;ä½ &#x27;</span><br><span class="line">    CompanyName       = &#x27;ä½ &#x27;</span><br><span class="line">    Description       = &#x27;Linux tree-like directory viewer with icon mode.&#x27;</span><br><span class="line">    PowerShellVersion = &#x27;5.1&#x27;</span><br><span class="line">    FunctionsToExport = @(&#x27;TreeView&#x27;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»™ä»–æ”¹å§æ”¹å§ï¼ŒæŠŠä¿¡æ¯å¡«ä¸€å¡«.</p>
<h3 id="ä½ å¯ä»¥é€‰æ‹©æ‰‹åŠ¨å‘å¸ƒç®€å•å¥½æ“ä½œ"><a class="markdownIt-Anchor" href="#ä½ å¯ä»¥é€‰æ‹©æ‰‹åŠ¨å‘å¸ƒç®€å•å¥½æ“ä½œ"></a> ä½ å¯ä»¥é€‰æ‹©æ‰‹åŠ¨å‘å¸ƒï¼ˆç®€å•å¥½æ“ä½œï¼‰</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Publish-Module -Path .\ -Repository PSGallery -NuGetApiKey <span class="string">&#x27;&lt;your-api-key&gt;&#x27;</span></span><br></pre></td></tr></table></figure>
<h4 id="publish-moduleå‘½ä»¤è¯¦è§£"><a class="markdownIt-Anchor" href="#publish-moduleå‘½ä»¤è¯¦è§£"></a> Publish-Moduleå‘½ä»¤è¯¦è§£</h4>
<h5 id="1-publish-module"><a class="markdownIt-Anchor" href="#1-publish-module"></a> 1. <code>Publish-Module</code></h5>
<p>PowerShell å†…ç½®çš„å‘å¸ƒå‘½ä»¤ï¼Œç”¨æ¥æŠŠä¸€ä¸ªæ¨¡å—ä¸Šä¼ åˆ° PowerShell Galleryã€‚</p>
<p>ä¸€èˆ¬ä½ çš„æ¨¡å—ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TreeView-PS/</span><br><span class="line">  TreeView.psd1</span><br><span class="line">  TreeView.psm1</span><br><span class="line">  Public/</span><br><span class="line">  Private/</span><br></pre></td></tr></table></figure>
<p><strong>åªè¦æœ‰ <code>.psd1</code> å°±å¯ä»¥å‘å¸ƒã€‚</strong></p>
<h5 id="2-path"><a class="markdownIt-Anchor" href="#2-path"></a> 2. <code>-Path .</code></h5>
<p>ä»£è¡¨â€œå½“å‰è·¯å¾„å°±æ˜¯æˆ‘è¦å‘å¸ƒçš„æ¨¡å—ç›®å½•â€ã€‚</p>
<p>ä½ çš„æ‰§è¡Œç›®å½•ä¸€èˆ¬å°±æ˜¯æ¨¡å—æ ¹ç›®å½•ï¼Œæ‰€ä»¥å†™ <code>.</code> å°±å¤Ÿäº†ã€‚</p>
<p>å¦‚æœæ”¾æ¨¡å—åœ¨å­ç›®å½•ï¼Œå¯èƒ½è¦å†™æˆï¼š<code>-Path ./src/TreeView</code></p>
<h5 id="3-repository-psgallery"><a class="markdownIt-Anchor" href="#3-repository-psgallery"></a> 3. <code>-Repository PSGallery</code></h5>
<p>æŒ‡å®šå‘å¸ƒç›®æ ‡ä»“åº“ï¼Œå°±æ˜¯å®˜æ–¹ PowerShell Galleryã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥å‘å¸ƒåˆ°ç§æœ‰ NuGet æœåŠ¡å™¨ï¼Œä½†ä½ ç°åœ¨ç”¨çš„æ˜¯é»˜è®¤çš„å…¬å…±ä»“åº“ã€‚</p>
<h5 id="4-nugetapikey-your-api-key"><a class="markdownIt-Anchor" href="#4-nugetapikey-your-api-key"></a> 4. <code>-NuGetApiKey &lt;your-api-key&gt;</code></h5>
<p>è¿™æ˜¯å‘å¸ƒåˆ° Gallery çš„ <strong>ç™»å½•å‡­è¯</strong>ã€‚</p>
<p>PowerShell Gallery ä½¿ç”¨ <strong>NuGet API Key</strong> é‰´æƒï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨Powershell Galleryç”³è¯·çš„keyã€‚</p>
<p>æ‰€ä»¥æ•´å¥å‘½ä»¤çš„æ„æ€æ˜¯ï¼š</p>
<blockquote>
<p>ä½¿ç”¨ GitHub Actions è‡ªåŠ¨å°†å½“å‰ç›®å½•çš„ PowerShell æ¨¡å—ä¸Šä¼ åˆ° PowerShell Galleryï¼Œ<br />
ä½¿ç”¨å­˜æ”¾åœ¨ç¯å¢ƒå˜é‡ä¸­çš„ NuGet API Key è®¤è¯ï¼Œå¹¶å‘å¸ƒã€‚</p>
</blockquote>
<h3 id="ä½¿ç”¨github-actionså®ç°cicdæ¨è"><a class="markdownIt-Anchor" href="#ä½¿ç”¨github-actionså®ç°cicdæ¨è"></a> ä½¿ç”¨GitHub Actionså®ç°CI/CDï¼ˆæ¨èï¼‰</h3>
<blockquote>
<p>CI/CD ä»£è¡¨æŒç»­é›†æˆ (Continuous Integration)å’ŒæŒç»­äº¤ä»˜/éƒ¨ç½² (Continuous Delivery/Deployment)ï¼Œæ˜¯ä¸€ç§è½¯ä»¶å¼€å‘æ–¹æ³•ï¼Œé€šè¿‡è‡ªåŠ¨åŒ–æ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²æµç¨‹ï¼Œå®ç°æ›´å¿«ã€æ›´é¢‘ç¹åœ°å‘å®¢æˆ·äº¤ä»˜é«˜è´¨é‡çš„è½¯ä»¶ã€‚æŒç»­é›†æˆ (CI) ä¾§é‡äºå¼€å‘äººå‘˜é¢‘ç¹å°†ä»£ç é›†æˆåˆ°å…±äº«å­˜å‚¨åº“å¹¶è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼›è€ŒæŒç»­äº¤ä»˜/éƒ¨ç½² (CD) åˆ™åœ¨æ­¤åŸºç¡€ä¸Šï¼Œè‡ªåŠ¨åŒ–å°†å˜æ›´äº¤ä»˜åˆ°ç”Ÿäº§ç¯å¢ƒçš„è¿‡ç¨‹ã€‚</p>
</blockquote>
<blockquote>
<p>è‹¥è¦ä½¿ GitHub åœ¨å­˜å‚¨åº“ä¸­å‘ç°ä»»ä½• GitHub Actions å·¥ä½œæµï¼Œå¿…é¡»å°†å·¥ä½œæµæ–‡ä»¶ä¿å­˜åœ¨åä¸º .github/workflows çš„ç›®å½•ä¸­ã€‚</p>
<p>ä½ å¯ä»¥ä¸ºå·¥ä½œæµæ–‡ä»¶æŒ‡å®šæ‰€éœ€çš„ä»»ä½•åç§°ï¼Œä½†å¿…é¡»ä½¿ç”¨ .yml æˆ– .yaml ä½œä¸ºæ–‡ä»¶æ‰©å±•åã€‚ YAML é€šå¸¸æ˜¯ç”¨äºé…ç½®æ–‡ä»¶çš„æ ‡è®°è¯­è¨€ã€‚<br />
â€“ Githubå®˜æ–¹æ–‡æ¡£</p>
</blockquote>
<h4 id="githubå»ºä»“"><a class="markdownIt-Anchor" href="#githubå»ºä»“"></a> Githubå»ºä»“</h4>
<ol>
<li>åœ¨Githubä¸Šåˆ›å»ºä»“åº“</li>
</ol>
<p>å»ºä¸€ä¸ªä»“åº“è®°ä½urlï¼Œå¦‚ï¼š<code>https://github.com/ä½ çš„è´¦å·/&lt;ä»“åº“åå­—&gt;.git</code></p>
<ol start="2">
<li>æœ¬åœ°åˆå§‹åŒ–gitå¹¶æ¨é€</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git init                  <span class="comment"># å¦‚æœè¿˜æ²¡åˆå§‹åŒ–è¿‡</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;Initial commit&quot;</span></span><br><span class="line">git branch -M main         <span class="comment"># ä¿è¯ä¸»åˆ†æ”¯æ˜¯ main</span></span><br><span class="line">git remote add origin https://github.com/ä½ çš„è´¦å·/&lt;ä»“åº“åå­—&gt;.git</span><br><span class="line">git push -u origin main</span><br></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨github-action"><a class="markdownIt-Anchor" href="#ä½¿ç”¨github-action"></a> ä½¿ç”¨Github Action</h4>
<p>ä½ éœ€è¦å…ˆæ¥åˆ°ç½‘é¡µç«¯ï¼Œç»™ä½ çš„ä»“åº“é…ç½®ä¸€ä¸ªä¸“ç”¨çš„ API Keyã€‚åˆ›å»ºæ–¹æ³•å¦‚å›¾ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Alpaca10086zyys/BlogImage/20251116220312.png" alt="åˆ›å»ºsecretè·¯å¾„" /></p>
<p>è¿™ä¸ªæ—¶å€™å°±æŠŠåˆšåˆšå­˜çš„API Keyæ‹¿å‡ºæ¥å°±è¡Œï¼Œç„¶åç»™ä»–å‘½åï¼Œä»¥åç”¨å¾—ä¸Šï¼Œæˆ‘è¿™é‡Œå‘½åä¸ºï¼š</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PSGalleryApiKey</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/Alpaca10086zyys/BlogImage/20251116220502.png" alt="" /></p>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º<code>./github/workflows/main.yml</code>ï¼Œgithubçš„æ•™ç¨‹æä¾›äº†ä¸€ä¸ªæ¨¡æ¿ï¼Œä¸‹é¢ä»¥æˆ‘çš„æ–¹æ³•ä¸ºä¾‹è§£é‡Šci/cd å·¥ä½œæµæ–‡ä»¶ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">PowerShell</span> <span class="string">Module</span> <span class="string">CI/CD</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">    <span class="attr">push:</span></span><br><span class="line">        <span class="attr">branches:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">main</span></span><br><span class="line">    <span class="attr">pull_request:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">    <span class="attr">test-and-publish:</span></span><br><span class="line">        <span class="attr">runs-on:</span> <span class="string">windows-latest</span></span><br><span class="line"></span><br><span class="line">        <span class="attr">steps:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">repo</span></span><br><span class="line">              <span class="attr">uses:</span> <span class="string">actions/checkout@v3</span></span><br><span class="line"></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">PowerShell</span></span><br><span class="line">              <span class="attr">uses:</span> <span class="string">actions/setup-powershell@v3</span></span><br><span class="line"></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">Pester</span></span><br><span class="line">              <span class="attr">run:</span> <span class="string">Install-Module</span> <span class="string">-Name</span> <span class="string">Pester</span> <span class="string">-Force</span> <span class="string">-Scope</span> <span class="string">CurrentUser</span></span><br><span class="line"></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">Pester</span> <span class="string">tests</span></span><br><span class="line">              <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">                  Invoke-Pester -Path .\Tests -Output Detailed</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Update</span> <span class="string">ModuleVersion</span></span><br><span class="line">              <span class="attr">shell:</span> <span class="string">pwsh</span></span><br><span class="line">              <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">                $psd1Path = &quot;.\TreeView.psd1&quot;</span></span><br><span class="line"><span class="string">                $psd1 = Get-Content $psd1Path</span></span><br><span class="line"><span class="string">                $newVersion = &quot;1.0.$env:GITHUB_RUN_NUMBER&quot;</span></span><br><span class="line"><span class="string">                $psd1 = $psd1 -replace &quot;ModuleVersion\s*=\s*&#x27;.*?&#x27;&quot;, &quot;ModuleVersion = &#x27;$newVersion&#x27;&quot;</span></span><br><span class="line"><span class="string">                Set-Content $psd1Path $psd1</span></span><br><span class="line"><span class="string"></span>              <span class="attr">env:</span></span><br><span class="line">                <span class="attr">GITHUB_RUN_NUMBER:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.run_number</span> <span class="string">&#125;&#125;</span></span><br><span class="line"></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Publish</span> <span class="string">to</span> <span class="string">PSGallery</span></span><br><span class="line">              <span class="attr">if:</span> <span class="string">github.ref</span> <span class="string">==</span> <span class="string">&#x27;refs/heads/main&#x27;</span> <span class="string">&amp;&amp;</span> <span class="string">github.event_name</span> <span class="string">==</span> <span class="string">&#x27;push&#x27;</span></span><br><span class="line">              <span class="attr">env:</span></span><br><span class="line">                  <span class="string">&lt;YourKey&gt;:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.&lt;YourKey&gt;</span> <span class="string">&#125;&#125;</span></span><br><span class="line">              <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line">                  <span class="string">Publish-Module</span> <span class="string">-Path</span> <span class="string">.</span> <span class="string">-NuGetApiKey</span> <span class="string">$env:&lt;YourKey&gt;</span> <span class="string">-Repository</span> <span class="string">PSGallery</span> <span class="string">-Force</span></span><br></pre></td></tr></table></figure>
<ol>
<li>checkoutï¼šæ‹‰å–ä»“åº“ä»£ç </li>
<li>setup PowerShellï¼šç¡®ä¿ Windows runner å®‰è£… PowerShell</li>
<li>å®‰è£… Pesterï¼šæœ€æ–°ç‰ˆæœ¬</li>
<li>è¿è¡Œå•å…ƒæµ‹è¯•ï¼šç¡®ä¿æ¨¡å—æ²¡æœ‰é—®é¢˜</li>
<li>å‘å¸ƒæ¨¡å—ï¼š
<ol>
<li>åªåœ¨ main åˆ†æ”¯ push æ—¶è§¦å‘</li>
<li>ä½¿ç”¨ä»“åº“ Secrets ä¸­çš„ PSGalleryApiKey</li>
<li><code>-Force</code> ä¼šè¦†ç›–åŒç‰ˆæœ¬æ¨¡å—ï¼Œå¦‚æœä½ æƒ³ä¸¥æ ¼æ§åˆ¶ç‰ˆæœ¬å¯ä»¥æ”¹æˆè‡ªåŠ¨ç”Ÿæˆæ–°ç‰ˆæœ¬</li>
</ol>
</li>
</ol>
<h4 id="pushåè‡ªåŠ¨æ‰§è¡Œæµç¨‹"><a class="markdownIt-Anchor" href="#pushåè‡ªåŠ¨æ‰§è¡Œæµç¨‹"></a> pushåè‡ªåŠ¨æ‰§è¡Œæµç¨‹</h4>
<p>å¦‚ä¸‹å›¾ï¼Œæ‰¾åˆ°æ­£åœ¨æ‰§è¡Œçš„workflowï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Alpaca10086zyys/BlogImage/20251116222115.png" alt="" /></p>
<p>ç­‰å¾…æ‰§è¡ŒæˆåŠŸæˆ–å¤±è´¥ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸€ä¸ªå¤±è´¥æ˜¯å•¥å‘¢ï¼Œæ˜¯è¿™ä¸ª-fæ”¯è·¯æ²¡æœ‰æˆåŠŸï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Alpaca10086zyys/BlogImage/20251116224035.png" alt="æŸ¥çœ‹æŠ¥é”™" /></p>
<h4 id="no-valid-module-was-found"><a class="markdownIt-Anchor" href="#no-valid-module-was-found"></a> No valid module was found</h4>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Line |</span><br><span class="line">   2 |  Publish-Module -Path . -NuGetApiKey $env:PSGalleryApiKey -Repository  â€¦</span><br><span class="line">     |  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><br><span class="line">     | The specified module with path &#x27;.&#x27; was not published because no valid module was found with that path.</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/Alpaca10086zyys/BlogImage/20251116225814.png" alt="" /></p>
<p>è¿™ä¸ªæŠ¥é”™æ˜¯å› ä¸ºä»“åº“æ— åˆæ³•æ¨¡å—ï¼Œæ³¨æ„åˆæ³•çš„psæ¨¡å—å¿…é¡»æ˜¯è¿™æ ·çš„ç»“æ„ï¼Œä½ åªèƒ½ç”¨å­æ–‡ä»¶å¤¹ä½œä¸ºç›®å½•ï¼Œä¸èƒ½ç”¨æ ¹ï¼š</p>
<figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;ModuleName&gt;/</span><br><span class="line">  &lt;ModuleName&gt;.psd1</span><br><span class="line">  &lt;ModuleName&gt;.psm1</span><br></pre></td></tr></table></figure>
<p>åªè¦æŠŠ<code>Publish-Module -Path . -NuGetApiKey $env:PSGalleryApiKey -Repository PSGallery -Force</code>æ”¹æˆ<code>Publish-Module -Path ./&lt;ç»“æ„æ­£ç¡®çš„å­æ–‡ä»¶å¤¹&gt; -NuGetApiKey $env:PSGalleryApiKey -Repository PSGallery -Force</code></p>
<p>ç»è¿‡åšæŒä¸æ‡ˆçš„è°ƒè¯•ç»ˆäºå‘å¸ƒæˆåŠŸã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/Alpaca10086zyys/BlogImage/20251116232230.png" alt="" /></p>
<h2 id="å‚è€ƒæ–‡æ¡£"><a class="markdownIt-Anchor" href="#å‚è€ƒæ–‡æ¡£"></a> å‚è€ƒæ–‡æ¡£</h2>
<blockquote>
<p>ps!æ¨èä¸€ä¸ªå¯ä»¥ç”¨æ¥å¿«é€Ÿè·å¾—md linkçš„æµè§ˆå™¨æ’ä»¶ï¼š<a target="_blank" rel="noopener" href="https://chromewebstore.google.com/detail/copy-as-markdown/fkeaekngjflipcockcnpobkpbbfbhmdn">Copy as Markdown</a></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/powershell/gallery/concepts/publishing-guidelines?view=powershellget-3.x">PowerShell åº“å‘å¸ƒæŒ‡å—å’Œæœ€ä½³åšæ³• - PowerShell | Microsoft Learn</a></p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/78417986/how-to-handle-dot-sourcing-in-pester-v5">PowerShell - å¦‚ä½•åœ¨ Pester v5 ä¸­å¤„ç†ç‚¹æºï¼Ÿ - Stack Overflow</a></p>
<p><a target="_blank" rel="noopener" href="https://pester.dev/docs/usage/code-coverage">Generating Code Coverage Metrics | Pester</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.github.com/zh/actions/tutorials/build-and-test-code/powershell">æ„å»ºå’Œæµ‹è¯• PowerShell - GitHub æ–‡æ¡£</a></p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>Alpaca Zhang</span>
                    </p>
                
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>Do you believe in <strong>DESTINY</strong>?</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>Â· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2025/11/17/%E5%8F%97%E5%A4%9F%E4%BA%86Windows%E8%87%AA%E5%B8%A6%E7%9A%84tree%EF%BC%8C%E6%88%91%E5%B9%B2%E8%84%86%E8%87%AA%E5%B7%B1%E5%86%99%E4%BA%86%E4%B8%80%E4%B8%AA%E7%89%88%E6%9C%AC%EF%BC%88%E7%B1%BBLinux%EF%BC%8C%E6%94%AF%E6%8C%81%E6%B7%B1%E5%BA%A6%E3%80%81%E5%9B%BE%E6%A0%87%E3%80%81%E5%BD%A9%E8%89%B2%E8%BE%93%E5%87%BA%EF%BC%89/">å—å¤Ÿäº†Windowsè‡ªå¸¦çš„treeï¼Œæˆ‘å¹²è„†è‡ªå·±å†™äº†ä¸€ä¸ªç‰ˆæœ¬ï¼ˆç±»Linuxï¼Œæ”¯æŒæ·±åº¦ã€å›¾æ ‡ã€å½©è‰²è¾“å‡ºï¼‰</a>
            
            
            <a class="next" rel="next" href="/2025/11/14/%E3%80%90%E8%85%BE%E8%AE%AF%E9%9D%92%E7%A7%91%E3%80%91ReactNative%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80%E6%8A%80%E5%B7%A7%E9%80%9F%E8%A7%88/">ã€è…¾è®¯é’ç§‘ã€‘ReactNativeå…¨æ ˆå¼€å‘åŸºç¡€å®æˆ˜é€Ÿè§ˆ</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>Â© Alpaca Zhang | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>